window.Driftly=Backbone.View.extend({template:Templates.layout,events:{"click li a.index":"renderIndexView","click li a.dashboard":"renderDashboardView"},initialize:function(a){console.log("Driftly is running"),$("body").append(this.render().el),this.router=new Driftly.Router({el:this.$el.find("#container")}),console.log(this),this.router.on("route",this.updateNav,this),console.log("something"),Backbone.history.start({pushState:!0})},render:function(){return this.$el.html(this.template()),this},renderDashboardView:function(a){a&&a.preventDefault(),this.router.navigate("/dashboard",{trigger:!0})},renderIndexView:function(a){a&&a.preventDefault(),this.router.navigate("/",{trigger:!0})},renderSigninView:function(a){a&&a.preventDefault(),this.router.navigate("/signin",{trigger:!0})},updateNav:function(a){this.$el.find(".navigation li a").removeClass("selected").filter("."+a).addClass("selected")}}),Driftly.AppModel=Backbone.Model.extend({initialize:function(a){}}),Driftly.SigninView=Backbone.View.extend({className:"signin",events:{"click li a.signin":"fbAuthPost"},initialize:function(){$("body").append(this.render().el),this.render()},fbAuthPost:function(a){a.preventDefault(),console.log("inside fbAuthPost")},render:function(){return this.$el.html(this.template()),this}}),Driftly.User=Backbone.Model.extend({urlRoot:"/users"}),Driftly.TileView=Backbone.View.extend({className:"tile",template:Templates.tile,events:{click:"renderProfile"},renderProfile:function(){var a=new Driftly.ProfileView({model:this.model});this.$el.html(a.render().el)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),Driftly.Users=Backbone.Collection.extend({model:Driftly.User,url:"/users"}),Driftly.DashboardView=Backbone.View.extend({className:"dashboard",template:Templates.dashboard,initialize:function(){this.collection.on("sync",this.addAll,this),this.collection.fetch(),console.log("fetching")},render:function(){return this.$el.empty(),this.$el.html(this.template()),this},addAll:function(){this.collection.forEach(this.addOne,this)},addOne:function(a){var b=new Driftly.TileView({model:a});this.$el.append(b.render().el)}}),Driftly.ConnectView=Backbone.View.extend({className:"connect",template:Templates.connect,render:function(){return this.$el.html(this.template()),this}}),Driftly.ProfileView=Backbone.View.extend({className:"profile",template:Templates.profile,render:function(){return $("#container").html(this.template(this.model.attributes)),this}}),Driftly.Router=Backbone.Router.extend({initialize:function(a){this.$el=a.el},routes:{"":"index",create:"create",dashboard:"dashboard",connect:"connect"},swapView:function(a){this.$el.html(a.render().el)},index:function(){},dashboard:function(){var a=new Driftly.Users,b=new Driftly.DashboardView({collection:a});this.swapView(b)},connect:function(){var a=new Driftly.Users,b=new Driftly.ConnectView({collection:a});this.swapView(b)},create:function(){},signin:function(){}});